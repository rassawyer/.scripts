#!/bin/bash

##if [[ "$*" == "-h" ]]; then
##	echo "Options include"
##	echo "-a - perform all functions contained in this script"
##	echo "-h - display this hfi
##p."
##	echo "-d - update pacman database"
##	echo "-f - update all packages"
##	echo "-k - update pacman trusted keys"
##	echo "-m - run reflector on mirror list first to get latest/fastest mirrors"
##	echo "-o - optimize pacman database"
##	echo "-p - purge old packages (leaving newest 3 in case of need to revert)"
##	echo "-r - remove unneeded dependencies"
##	echo "-u - update list of installed packages"
##	echo "-s - sync list of installed packages to remote site.(GoDaddy webhosting)"
##	echo "-y - remove all cached versions of uninstalled packaegs."
##	exit 0
##fi
##
##echo "Backing up pacman database..."
##tar -cjf /home/rassawyer/.bak/pacman-database.tar.bz2 /var/lib/pacman/local
##
##if [[ "$*" == "-m" ]]; then
##	if [[ $EUID -ne 0 ]]; then
##		echo "This function requires root access. Please rerun this script using 'sudo'"
##		exit 0
##	fi
##else
##		echo "Updating mirrorlist to fastest and most recently updated"
##		reflectorscript
##fi
##if [[ "$*" == "-y" ]]; then
##	if [[ $EUID -ne 0 ]]; then
##		echo "This function requires root access. Please rerun this script using 'sudo'"
##		exit 0
##	fi
##else
##		echo "Removing cached versions of uninstalled packages." 
##		paccache -ruk0
##fi
##if [[ "$*" == "-r" ]]; then
##	if [[ $EUID -ne 0 ]]; then
##		echo "This function requires root access. Please rerun this script using 'sudo'"
##		exit 0
##	fi
##else
##		pacman -Rscn --noconfirm $(pacman -Qtdq)
##fi
##if [[ "$*" == "-p" ]]; then
##	if [[ $EUID -ne 0 ]]; then
##		echo "This function requires root access. Please rerun this script using 'sudo'"
##		exit 0
##	fi
##else
##		echo "Removing old packages..."
##		paccache -r
##fi
##if [[ "$*" == "-k" ]]; then
##	echo "Updating signature keys..."
##	pacman-key --populate archlinux
##fi
##if [[ "$*" == "-d" ]]; then
##	echo echo "Updating database..."
##	updatedb		
##fi
##if [[ "$*" == "-o" ]]; then
##	echo "Optimizing database..."
##	pacman-optimize && sync		
##fi
##if [[ "$*" == "-f" ]]; then
##	if [[ $EUID -ne 0 ]]; then
##		echo "This function requires root access. Please rerun this script using 'sudo'"
##		exit 0
##	fi
##else
##		echo "Performing system upgrade..."
##		pacman -Syyu
##fi
##if [[ "$*" == "-u" ]]; then
##	echo "Updating lists of installed packages."
##	rm -rfv /home/rassawyer/.scripts/lists/*
##	pacman -Qqen > /home/rassawyer/.scripts/lists/official.list
##	pacman -Qqem > /home/rassawyer/.scripts/lists/unofficial.list
##	sort -d /home/rassawyer/.scripts/lists/official.list > /home/rassawyer/.scripts/lists/official.list
##	sort -d /home/rassawyer/.scripts/lists/unofficial.list > /home/rassawyer/.scripts/lists/unofficial.list
##	comm -2 -3  /home/rassawyer/.scripts/lists/official.list  /home/rassawyer/.scripts/lists/unofficial.list  >  /home/rassawyer/.scripts/lists/oddball.list
##fi
##if [[ "$*" == "-s" ]]; then
##	echo "Syncing lists to remote site."
##	eval `ssh-agent`
##	ssh-add /home/rassawyer/.ssh/godaddy
##	rsync -avz  /home/rassawyer/.scripts/lists/ robbie12abby@truegeekllc.com:/home/robbie12abby/Dropbox/lists/
##fi
##
##if [[ "$*" == "-a" ]]; then
	echo "Updating mirrorlist to fastest and most recently updated"
	reflectorscript
	echo "Removing cached versions of uninstalled packages." 
	paccache -ruk0
	pacman -Rscn --noconfirm $(pacman -Qtdq)
	echo "Removing old packages..."
	paccache -r
	echo "Updating signature keys..."	pacman-key --populate archlinux
	echo echo "Updating database..."
	updatedb		
	echo "Optimizing database..."
	pacman-optimize && sync		
	echo "Performing system upgrade..."
	pacman -Syyu
	echo "Updating lists of installed packages."
	rm -rfv /home/rassawyer/.scripts/lists/*
	pacman -Qqen > /home/rassawyer/.scripts/lists/official.list
	pacman -Qqem > /home/rassawyer/.scripts/lists/unofficial.list
	sort -d /home/rassawyer/.scripts/lists/official.list > /home/rassawyer/.scripts/lists/official.list
	sort -d /home/rassawyer/.scripts/lists/unofficial.list > /home/rassawyer/.scripts/lists/unofficial.list
	comm -2 -3  /home/rassawyer/.scripts/lists/official.list  /home/rassawyer/.scripts/lists/unofficial.list  >  /home/rassawyer/.scripts/lists/oddball.list
	echo "Syncing lists to remote site."
	eval `ssh-agent`
	ssh-add /home/rassawyer/.ssh/godaddy
	rsync -avz  /home/rassawyer/.scripts/lists/ robbie12abby@truegeekllc.com:/home/robbie12abby/Dropbox/lists/
fi
sudo -k

echo "Optimize and update successful; exiting..."

play /audio/done.ogg
